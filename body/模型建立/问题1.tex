\subsection{问题一}

\subsubsection{离散 Radon 变换模型}

CT成像的物理过程在数学上可以通过Radon变换进行描述。
Radon变换是一种将二维空间函数投影至其在线积分集合上的积分变换，
简单来说，就是一个物体映射在不同角度下的“投影”的集合。\par

在本题中，已知二维断层切片的吸收率分布是一个二维函数 $f(x,y)$ ，
当一束平行的X射线以角度 $\theta$ 穿过，位于探测器坐标系中 $\rho$ 位置的探测单元所接收到的信号强度$p(\rho,\theta)$，
即为函数 $f(x,y)$ 沿着直线 $x\cos\theta+y\sin\theta=\rho$ 的线积分，即：
$$p(\rho,\theta)=\int_{-\infty}^{\infty}\int_{-\infty}^{\infty}f(x,y)\delta(x\cos\theta+y\sin\theta-\rho)dxdy$$

其中 $\delta(\cdot)$ 是狄拉克函数，其性质确保了积分仅在指定的射线上进行。
仅当 $x\cos\theta+y\sin\theta=\rho$ 时，$f(x,y)$ 才对积分有贡献。
所有投影值 $p(\rho,\theta)$ 构成的二维图像被称为正弦图。\par

在实际的数字成像系统中，探测器单元数量有限，且待重建的吸收率函数 $f(x,y)$ 在离散的像素网格上表示。
因此，必须对连续的Radon变换模型进行离散化。

本文将积分运算近似为有限求和，并将狄拉克函数替换为其离散形式——单位脉冲序列$\delta[\cdot]$。
假设图像空间被离散为 $N \times M$ 的像素网格，则在第 $j$ 个角度 $\theta_j$ 下，第 $i$ 个探测器单元 $\rho_i$ 的投影值可以表示为：
$$p(\rho_i,\theta_j)=\sum_{k=1}^{N}\sum_{l=1}^{M}f(x_k,y_l)\delta[x_k\cos\theta_j+y_l\sin\theta_j-\rho_i]$$

在本问题中，图像网格大小为 $M=N=256$，探测器单元序号$i \in [1,512]$，扫描角度序号$j \in [1,180]$。

探测器单元的物理位置 $\rho_i$ 可定义为：

\begin{equation*}
\rho_i = i\Delta\rho, \quad i=1,2,\cdots,512 \\
\end{equation*}

取$\theta_0$ 为旋转前的初始角度，系统参数的离散化关系为：

\begin{equation*}
\theta_j = \Delta\theta_j + \theta_{j-1}, \quad j=1,2,\cdots,180
\end{equation*}

将此整体模拟成一个二维平面内的模板系统，由一个中心位于原点、长轴为 $a$、短轴为 $b$ 的椭圆和一个半径为 $r$、圆心位于 $(m, 0)$ 的圆构成。当一束与水平方向成夹角 $\theta$ 的平行光照射该模板时，两个图形将在垂直于光线方向的探测器平面上形成阴影。设光线方向的单位向量为 $\mathbf{d} = (\cos\theta, \sin\theta)$，则垂直于光线的探测器方向为单位向量 $\mathbf{n} = (-\sin\theta, \cos\theta)$。

椭圆在探测器方向上的投影为对称区间，其半宽度为：
\[
w_e(\theta) = \sqrt{b^2 \sin^2\theta + a^2 \cos^2\theta}
\]

圆心在投影方向上的坐标为：
\[
p_c = -m \sin\theta
\]

其对应的投影区间为 $[p_c - r,\ p_c + r] = [-m \sin\theta - r,\ -m \sin\theta + r]$。将椭圆和圆在探测器方向上的投影视为两个区间，则它们的总阴影长度为这两个区间的并集长度。可以统一表示为如下解析表达式：
\begin{equation}
\begin{split}
L_{\text{total}}(\theta) =\ & \max\left( \sqrt{b^2 \sin^2\theta + a^2 \cos^2\theta},\ -m \sin\theta + r \right) \\
& - \min\left( -\sqrt{b^2 \sin^2\theta + a^2 \cos^2\theta},\ -m \sin\theta - r \right)
\end{split}
\end{equation}






\subsubsection{测器单元间距的标定模型}

根据CT成像的物理原理，平行X射线束穿过待测物体后，其在探测器上形成的投影宽度与物体的实际物理尺寸存在直接的比例关系。
具体而言，若物体在某一方向上的投影物理宽度为 $L$，该投影覆盖了 $N$ 个探测器单元，
则探测器单元之间的等效物理距离（即单元间距）$\Delta\rho$可表示为：

$$L = N \cdot \Delta\rho$$

为精确标定 $\Delta\rho$，我们分析了附件2中给出的模板投影数据（共180个角度）。
观察发现，这些数据呈现出两种显著的分布模式：单峰分布与双峰分布。
单峰分布对应于X射线束在某些角度下同时穿过椭圆与圆形两个介质，导致它们的投影发生重叠；
而双峰分布则对应于射线束在另一些角度下分别穿过两个独立的介质，其投影在探测器上形成两个由零值区域隔开的非零信号区域。
\par


为实现精确标定，必须利用一个尺寸已知的、在投影中易于识别的几何特征。
模板中的圆形介质是一个理想的标定参照物。其关键优势在于，作为一个中心对称图形，圆形在任意角度下的投影宽度恒为其直径，
即 $L_circle = D_circle = 4 mm$。
这一特性为我们提供了一个稳定、可靠的参考长度，有效避免了因椭圆投影宽度随角度变化而引入的复杂性。\par



因此，本模型的核心策略是：
从双峰分布的投影数据中，精确分离出仅由圆形介质产生的投影信号段，利用其恒定的物理宽度与对应的探测器单元数来求解 $\Delta\rho$。
为实施上述策略，我们设计了如下算法：\par
\begin{enumerate}[label=(\arabic*), left=0.5em]
\item 有效投影筛选：\par
遍历全部180组投影数据。通过算法识别出具有“非零段-零段-非零段”结构的双峰数据。
根据模板几何信息可知，圆形的尺寸远小于椭圆，因此其投影宽度也相应较窄。
在每一组双峰数据中，将宽度较窄的那个非零数据段识别为圆形的有效投影，
如下图\ref{fig:category}中红色部分所示。

\begin{figure}[h] 
    \centering 
    \includegraphics[width=0.8\textwidth]{圆形投影分离.png} 
    \caption{附件2数据分类标识图} 
    \label{fig:category}
\end{figure}


\item 投影宽度统计：\par
对于每一个被识别出的圆形有效投影，我们统计其覆盖的探测器单元数量，记为 $N_i$，其中 $i$ 是有效投影的索引。

\item 参数估计与优化：\par
由于实际数据中可能存在噪声和离散化误差，直接使用单次测量值不够稳健。
为提高标定结果的精度和鲁棒性，我们对所有筛选出的 $k$ 个有效投影宽度 $N_1, N_2, ..., N_k$ 求取算术平均值，
得到平均投影宽度 $N_avg$：
$$N_{avg} = \frac{1}{k} \sum_{i=1}^{k} N_i$$
\end{enumerate}